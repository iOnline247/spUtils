<script type="text/javascript" src="/SPDev/scripts/roboCAML.js"></script>
<script type="text/javascript" src="/SPDev/scripts/spUtils.unmin.js"></script>


<script type="text/javascript">
	//console.dir(SP);
	//debugger;

/***************************************
	Test 1 ~ getListItems - valid list
***************************************/

			spUtils.getListItems({
				//webURL: ,
				listName : "Project Tasks",
				CAMLQuery: "<View><Query><Where><Eq><FieldRef Name='ID' /><Value Type='Counter'>59</Value></Eq></Where></Query></View>",
				//Folder,
				Include : ["Title", "RelatedIssues", "ID"],
				success : function( data, ctx ) {

					debugger;
					for ( var i = 0; i < data.length; i++ ) {
						console.log( "RelatedIssues: " + data[ i ].RelatedIssues + "\n" + "ID: " + data[ i ].ID );
					}

					//debugger;
				},
				error : function( ctx, error ) {
					debugger;
				},
				debug : true
			});

/***************************************
	Test 2 ~ getListItems - invalid list
***************************************/
			spUtils.getListItems({
				//webURL: ,
				listName : "InvalidList",
				//CAMLQuery,
				//Folder,
				Include : ["Title", "ID"],
				success : function( data, ctx ) {

					for ( var i = 0; i < data.length; i++ ) {
						console.log( "Title: " + data[ i ].Title + "\n" + "ID: " + data[ i ].ID );
					}

					//debugger;
				},
				error : function( ctx, error ) {
					debugger;
				},
				debug : true
			});


/***************************************
	Test 3 ~ getListItems - Wrapped with ExecuteOrDelayUntilScriptLoaded
***************************************/
			ExecuteOrDelayUntilScriptLoaded(
				function() {
					spUtils.getListItems({
						//webURL: ,
						listName : "scripts",
						//CAMLQuery,
						//Folder,
						Include : ["Title", "ID"],
						success : function( data, ctx ) {

							for ( var i = 0; i < data.length; i++ ) {
								console.log( "Title: " + data[ i ].Title + "\n" + "ID: " + data[ i ].ID );
							}

							//debugger;
						},
						error : function( ctx, error ) {
							debugger;
						},
						debug : true
					});
				},
				'sp.js'
			);

/***************************************
	Test 4 ~ getListItems - Wrapped with $(document).ready() & ExecuteOrDelayUntilScriptLoaded
***************************************/
		$(document).ready(function() {
			ExecuteOrDelayUntilScriptLoaded(
				function() {
					spUtils.getListItems({
						//webURL: ,
						listName : "scripts",
						//CAMLQuery,
						//Folder,
						Include : ["Title", "ID"],
						success : function( data, ctx ) {

							for ( var i = 0; i < data.length; i++ ) {
								console.log( "Title: " + data[ i ].Title + "\n" + "ID: " + data[ i ].ID );
							}

							//debugger;
						},
						error : function( ctx, error ) {
							debugger;
						},
						debug : true
					});
				},
				'sp.js'
			);
		});

/***************************************
	Test 5 ~ getListItems - Wrapped with ExecuteOrDelayUntilScriptLoaded & $(document).ready()
***************************************/
		ExecuteOrDelayUntilScriptLoaded(
			function() {
				$(document).ready(function() {
					spUtils.getListItems({
						//webURL: ,
						listName : "scripts",
						//CAMLQuery,
						//Folder,
						Include : ["Title", "ID"],
						success : function( data, ctx ) {

							for ( var i = 0; i < data.length; i++ ) {
								console.log( "Title: " + data[ i ].Title + "\n" + "ID: " + data[ i ].ID );
							}

							//debugger;
						},
						error : function( ctx, error ) {
							debugger;
						},
						debug : true
					});
				});
			},
			'sp.js'
		);

/***************************************
	Test 6 ~ getListItems - Use ViewFields in CAMLQuery and Include: Should fail
***************************************/
			spUtils.getListItems({
				//webURL: ,
				listName : "scripts",
				CAMLQuery : "<View><ViewFields><FieldRef Name='Title' /><FieldRef Name='ID' /></ViewFields><Query><Where><Neq><FieldRef Name='ID' /><Value Type='Counter'>0</Value></Neq></Where></Query></View>",
				//Folder,
				Include : ["Title", "ID", "Author"],  //Fails when ViewFields and Include have different columns
				success : function( data, ctx ) {

					for ( var i = 0; i < data.length; i++ ) {
						console.log( "Title: " + data[ i ].Title + "\n" + "ID: " + data[ i ].ID );
					}

					//debugger;
				},
				error : function( ctx, error ) {
					debugger;
				},
				debug : true
			});

/***************************************
	Test 7 ~ updateListItems - Updates 1 item based on ID
***************************************/
		spUtils.updateListItems({
			listName: "scripts",
			id: 42,
			valuePairs: [ [ "Title", spUtils.isoDate() ] ]
		});

/***************************************
	Test 8 ~ updateListItems - Updates 2 items based on ID
***************************************/
		spUtils.updateListItems({
			listName : "scripts",
			updates : {
				5 : { // the key is the item ID
					valuePairs : [ ["Title", spUtils.isoDate()] ]
				},
				6 : {
					valuePairs : [ ["Title", spUtils.isoDate()] ]
				}
			}
		});

/***************************************
	Test 9 ~ createListItems - Create an item
***************************************/
		spUtils.createListItems({
			listName : "Project Tasks",
			updates: [
				{
					Status: "Resolved",
					"RelatedProject{L}" : 1,
					Title: "Created by moi"
				}
			],
			success: function() { debugger; }
		});
		
/***************************************
	Test 10 ~ createListItems - Create 2 items
***************************************/
		spUtils.createListItems({
			listName : "Project Tasks",
			updates: [
				{
					Status: "Resolved",
					"RelatedProject{L}" : 1,
					Title: "Created in multitudes"
				},
				{
					Status: "Closed", //Choice
					"RelatedProject{L}" : 2, //Lookup, notice the suffix delimiter
					Title: "Created for us by us",
					Priority: "(1) High", //Choice
					V3Comments: "Saying something <b>important</b> here makes you feel <i>important!</i>", //Rich Text
					"RelatedIssues{L}": "3;#4" //MultiLookup, notice the ;# delimiter
				}
			],
			success: function() { debugger; }
		});	

/***************************************
	Test 11 ~ updateListItems - Create an item ~ sytax sugar
***************************************/
		spUtils.updateListItems({
			op: "create",
			listName : "Project Tasks",
			updates: [
				{
					Status: "Resolved",
					"RelatedProject{L}" : 2,
					Title: "Created on" + spUtils.isoDate()
				}
			],
			success: function() { debugger; }
		});
		
/***************************************
	Test 12 ~ updateListItems - Create 2 items ~ syntax sugar
***************************************/
		spUtils.updateListItems({
			op: "create",
			listName : "Project Tasks",
			updates: [
				{
					Status: "Resolved",
					"RelatedProject{L}" : 1,
					Title: "Created in multitudes"
				},
				{
					Status: "Closed", //Choice
					"RelatedProject{L}" : 2, //Lookup, notice the suffix delimiter
					Title: "Created for us by us",
					Priority: "(1) High", //Choice
					V3Comments: "Saying something <b>important</b> here makes you feel <i>important!</i>", //Rich Text
					"RelatedIssues{L}": "3;#14" //MultiLookup, notice the ;# delimiter
				}
			],
			success: function() { debugger; }
		});	
		
/***************************************
	Test 13 ~ deleteListItems - Delete 1 item
***************************************/
		spUtils.deleteListItems({
			listName : "Project Tasks",
			id: 12,
			success: function() { debugger; }
		});
	
/***************************************
	Test 14 ~ deleteListItems - Delete multiple items
***************************************/
		spUtils.deleteListItems({
			listName : "Project Tasks",
			id: [ 23, 24, 26, 28 ], // If item doesn't exist, an error will be thrown. The items processed prior to the error will still be modified accordingly.
			success: function() { debugger; }
		});
		
/***************************************
	Test 15 ~ updateListItems - Delete 1 item ~ a lil syntax sugar
***************************************/
		spUtils.updateListItems({
			listName : "Project Tasks",
			op: "delete",
			id: 1,
			success: function() { debugger; }
		});

/***************************************
	Test 16 ~ updateListItems - Delete multiple items ~ a lil syntax sugar
***************************************/
		spUtils.updateListItems({
			listName : "Project Tasks",
			op: "delete",
			id: [ 3, 4, 6, 8 ], // If item doesn't exist, an error will be thrown. The items processed prior to the error will still be modified accordingly.
			success: function() { debugger; }
		});
		
		
/***************************************
	Test 17 ~ createListItems - Create folder and modify leaf name
***************************************/
		spUtils.createListItems({
			listName : "Project Tasks",
			updates: [
				{
					folderUrl: "/SPDev/Lists/ListName",
					folderName: "folderName"
				}
			],
			success: function() { debugger; }
		});	
		
/***************************************
	Test 18 ~ createListItems - Create folder, modify leaf name, and metadata.
***************************************/
		spUtils.createListItems({
			listName : "Project Tasks",
			updates: [
				{
					folderUrl: "/SPDev/Lists/ProjectTasks",
					folderName: "folder1",
					multiLinesHTML: "Saying something <b>important</b> here makes you feel <i>important!</i>", //Rich Text
					//personGroup: "dev\administrator",
					chkBox: false,
					ol_EventAddress: "Event addy",
					ContentTypeId : "0x012000C77A544EBDFBD2419EE2F54FDAE1A9A200936BBDFC53359E4681BF0F0DC7DD3AE7", //FolderSorter CT Name
					URL: "http://google.com, Google"
				}
			],
			success: function() { debugger; }
		});	

		
/***************************************
	Test 19 ~ createListItems - Create item based on CT.
***************************************/
		spUtils.createListItems({
			listName : "Project Tasks",
			updates: [
				{
					ContentTypeId : "0x01040004B13BF0D61E0D44A7D0327C51C01D8A", //Announcements CT
					Title: "It's my title and I'll type it when I want to."
				}
			],
			success: function() { debugger; }
		});		
		
/***************************************
	Test 20 ~ addStatus - Create a status notification
***************************************/
	spUtils.addStatus("Does <span style='color:red;'>HTML</span> work in a status?", "yellow");		

/***************************************
	Test 21 ~ addStatus/removeStatus - Create a status notification, then remove it.
***************************************/
	var myStatus = spUtils.addStatus("Does <span style='color:red;'>HTML</span> work in a status?", "green");		

	spUtils.removeStatus( myStatus );
		
		
/***************************************
	Test 22 ~ createListItems - Create item with people picker value.
***************************************/
		spUtils.createListItems({
			listName : "Project Tasks",
			updates: [
				{
					"AssignedTo{P}" : "DEV\Administrator",
					Title: "Single Person/Group"
				}
			],
			success: function() { debugger; }
		});		
		
/***************************************
	Test 23 ~ createListItems - Create item with multiple people picker values.
***************************************/
		spUtils.createListItems({
			listName : "Project Tasks",
			updates: [
				{
					folderName: "folder2People",
					ContentTypeId : "0x012000C77A544EBDFBD2419EE2F54FDAE1A9A200936BBDFC53359E4681BF0F0DC7DD3AE7",
					"personGroup{P}" : "DEV\\Administrator;#DEV\\SPUser1;#4",  //Will handle mixture of user IDs or the name of the user. Groups do not need domain prefix from what I can tell. User names need two slashes however. That may suck.
					Title: "Multiple People/Groups"
				}
			],
			success: function() { debugger; }
		});		
/*******************************************
TO DO ITEMS
1. Handle content types with create/update
2. Add folderUrl options to updateListItems
3. Create tests for all other methods 
4. Get startWorkflow working
5. Implement debug option for all CRUD options
********************************************/




</script>

<div id="showMe"></div>